getgenv().Settings = {
	Autofarm = false;
	AutofarmCooldown = 2;
	AutoPickupGun = false;
	Automessage = false;
}

local DiscordLib = loadstring(game:HttpGet"https://raw.githubusercontent.com/dawid-scripts/UI-Libs/main/discord%20lib.txt")()

local win = DiscordLib:Window("TRXDENT")

local serv = win:Server("TRXDENT MM2", "")

local autofarm = serv:Channel("Autofarm")

local maps = {"Mansion2","Office3","Bank2","PoliceStation","BioLab","Hotel","MilBase","House2","Hospital3",""}
local player = game.Players.LocalPlayer

-- Save System

local filename = "TRXDENT_MM2Autofarm.lua"

function loadSettings()
	print("Loading Settings")
	local HttpService = game:GetService("HttpService");
	if (readfile and isfile and isfile(filename)) then
		getgenv().Settings = HttpService:JSONDecode(readfile(filename));
	else
		print("File Not Found")	
	end
end

function saveSettings()
	local Logsz;
	local HttpService = game:GetService("HttpService");
	if (writefile) then
		Logsz = HttpService:JSONEncode(Settings);
		writefile(filename, Logsz)
	else
		print("Windows Rejected Save Request")
	end
end

loadSettings()

-- Autofarm

autofarm:Toggle("Autofarm",Settings.Autofarm, function(bool)
    if bool == false then
        print("Disabled")
        Settings.Autofarm = false
    end
    if bool == true then
        print("Enabled")
        Settings.Autofarm = true
    end
end)

autofarm:Toggle("Auto Pickup Gun",Settings.AutoPickupGun, function(bool)
    if bool == false then
        print("Disabled")
        Settings.AutoPickupGun = false
    end
    if bool == true then
        print("Enabled")
        Settings.AutoPickupGun = true
    end
end)

autofarm:Seperator()

autofarm:Slider("Autofarm Speed", 2, 20, Settings.AutofarmCooldown, function(t)
	Settings.AutofarmCooldown = t
end)

-- Functions

function saveValues()
	spawn(function()
		while wait(20) do
			saveSettings()
			wait(1)
			loadSettings()
		end
	end)
end

saveValues()

local function aufrm()
	local humn = game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
	if not Settings.Autofarm then
		repeat
			wait(0.1)
		until Settings.Autofarm
		return
	end
	if humn then
		while Settings.Autofarm == true and wait() and humn.Parent.Humanoid ~= 0 do
			for i, v in pairs(maps) do
				local g = game:GetService("Workspace"):FindFirstChild(v)
				if g then
					local coin = g.CoinContainer
					for a, b in pairs(coin:GetChildren()) do
						if b.Name == "Coin_Server" then
							game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(b.Position)
							wait(Settings.AutofarmCooldown)
							if not Settings.Autofarm then return end
							if not humn then return end
						end
					end
				end
			end
		end
	elseif not humn then
		repeat
			wait(0.1)
		until humn
		if humn then return end
	end
end

local function AutopickGun()
    local checkdrop = game:GetService("Workspace"):FindFirstChild("GunDrop")
    if checkdrop then
		local charpos = game.Players.LocalPlayer.Character.HumanoidRootPart.Position
        local gundrop = game:GetService("Workspace").GunDrop.Position
		wait(0.2)
        repeat
			wait(0)
			game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(gundrop)
		until not checkdrop
		wait(0.2)
		game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(charpos)
    end
end

while Settings.AutoPickupGun == true do
    AutopickGun()
	if not Settings.AutoPickupGun then return end
end

while true and wait(0.5) do
	aufrm()
end
